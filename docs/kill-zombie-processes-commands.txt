# Commands to Kill Zombie/Stuck Processes in Termux

## Quick One-Liner (Kill All Build Processes)

```bash
adb shell "run-as com.termux sh -c 'export PREFIX=/data/data/com.termux/files/usr && export PATH=\$PREFIX/bin:\$PATH && pkill -9 python && pkill -9 pip && pkill -9 clang && pkill -9 rustc && pkill -9 ninja && pkill -9 make && pkill -9 meson && pkill -9 cc && echo \"All processes killed\"'"
```

## Complete Cleanup Sequence

### Step 1: Kill All Build Processes

```bash
adb shell "run-as com.termux sh -c 'export PREFIX=/data/data/com.termux/files/usr && export PATH=\$PREFIX/bin:\$PATH && \
pkill -9 python 2>/dev/null || true && \
pkill -9 pip 2>/dev/null || true && \
pkill -9 clang 2>/dev/null || true && \
pkill -9 rustc 2>/dev/null || true && \
pkill -9 ninja 2>/dev/null || true && \
pkill -9 make 2>/dev/null || true && \
pkill -9 meson 2>/dev/null || true && \
pkill -9 cc 2>/dev/null || true && \
pkill -9 cmake 2>/dev/null || true && \
echo \"All processes killed\"'"
```

### Step 2: Force Stop Termux (Releases Memory)

```bash
adb shell "am force-stop com.termux"
```

### Step 3: Check Memory

```bash
adb shell "free -h"
```

### Step 4: Verify No Processes Remain

```bash
adb shell "run-as com.termux sh -c 'export PREFIX=/data/data/com.termux/files/usr && export PATH=\$PREFIX/bin:\$PATH && ps aux | grep -E \"python|pip|clang|rustc|ninja|make|meson\" | grep -v grep || echo \"No processes found\"'"
```

## Check for Zombie Processes First

```bash
# List all build-related processes
adb shell "run-as com.termux sh -c 'export PREFIX=/data/data/com.termux/files/usr && export PATH=\$PREFIX/bin:\$PATH && ps aux | grep -E \"python|pip|clang|gcc|rustc|ninja|make|meson|cc\" | grep -v grep'"
```

## Nuclear Option (If System is Completely Frozen)

```bash
# 1. Kill all processes
adb shell "run-as com.termux sh -c 'pkill -9 -f python && pkill -9 -f pip && pkill -9 -f clang && pkill -9 -f rustc && pkill -9 -f ninja && pkill -9 -f make'"

# 2. Force stop Termux
adb shell "am force-stop com.termux"

# 3. Restart emulator (use launch_pixel4a.bat script)
# Or manually:
adb -s emulator-5554 emu kill
```

## Check System Memory Before/After

```bash
# Before cleanup
adb shell "free -h"

# After cleanup
adb shell "free -h"
```

## Check Termux Memory Usage

```bash
adb shell "dumpsys meminfo com.termux | head -30"
```

## Processes to Kill

Common zombie processes:
- `python` / `python3` - Python processes
- `pip` - Package installer
- `clang` / `gcc` - C/C++ compilers
- `rustc` / `cargo` - Rust compiler
- `ninja` - Build system
- `make` - Build automation
- `meson` - Build system
- `cc` / `c++` - Compilers
- `cmake` - Build system

## Prevention

After each build, run cleanup:

```bash
# Add to ~/.bashrc or run after builds
pkill -9 python pip clang rustc ninja make meson 2>/dev/null || true
```

## Notes

- Use `-9` flag for `pkill` to force kill (SIGKILL)
- `2>/dev/null || true` prevents errors if process doesn't exist
- Force stopping Termux releases all memory held by the app
- If system is still unresponsive, restart the emulator

